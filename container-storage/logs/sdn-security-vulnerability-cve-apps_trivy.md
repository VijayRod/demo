```
# cve.trivy.install
aks-nodepool1-98803342-vmss000000:/# apt update -y && apt install snapd -y && export PATH=$PATH:/snap/bin && snap install trivy
```

```
# cve.trivy.install2
# Credits: Andrei Barbu
sudo apt-get install wget apt-transport-https gnupg lsb-release
wget -qO - https://aquasecurity.github.io/trivy-repo/deb/public.key | sudo apt-key add -
echo deb https://aquasecurity.github.io/trivy-repo/deb $(lsb_release -sc) main | sudo tee -a /etc/apt/sources.list.d/trivy.list
sudo apt-get update
sudo apt-get install trivy
```

```
# cve.trivy.scan

aks-nodepool1-98803342-vmss000000:/# trivy image --ignore-unfixed mcr.microsoft.com/oss/nvidia/k8s-device-plugin:v0.14.5 | grep -E 'HIGH|CRITICAL' | grep fixed
│ golang.org/x/net           │ CVE-2024-45338 │ HIGH     │ fixed  │ v0.18.0           │ 0.33.0
│ github.com/NVIDIA/nvidia-container-toolkit │ CVE-2024-0132  │ CRITICAL │ fixed  │ v1.14.7-0.20240229083338-37b1e37c8f2f │ 1.16.2                           │ nvidia-container-toolkit: Time-of-check Time-of-use (TOCTOU) │

aks-nodepool1-98803342-vmss000001:/# trivy image --ignore-unfixed mcr.microsoft.com/oss/nvidia/k8s-device-plugin:v0.14.5 | grep -E 'HIGH|CRITICAL'
│ stdlib                     │ CVE-2024-24790 │ CRITICAL │        │ v1.20.5           │ 1.21.11, 1.22.4     │ golang: net/netip: Unexpected behavior from Is methods for   │
│                            │ CVE-2023-39325 │ HIGH     │        │                   │ 1.20.10, 1.21.3     │ golang: net/http, x/net/http2: rapid stream resets can cause │
Total: 28 (UNKNOWN: 0, LOW: 0, MEDIUM: 21, HIGH: 5, CRITICAL: 2)

aks-nodepool1-98803342-vmss000000:/# trivy image --ignore-unfixed mcr.microsoft.com/oss/nvidia/k8s-device-plugin:v0.14.5 | grep Total -B 3
mcr.microsoft.com/oss/nvidia/k8s-device-plugin:v0.14.5 (ubuntu 20.04)
=====================================================================
Total: 57 (UNKNOWN: 0, LOW: 24, MEDIUM: 33, HIGH: 0, CRITICAL: 0)
--
usr/bin/config-manager (gobinary)
=================================
Total: 26 (UNKNOWN: 0, LOW: 0, MEDIUM: 20, HIGH: 5, CRITICAL: 1)
--
usr/bin/nvidia-device-plugin (gobinary)
=======================================
Total: 28 (UNKNOWN: 0, LOW: 0, MEDIUM: 21, HIGH: 5, CRITICAL: 2)
```

```
# cve.trivy.scan.out

root@aks-nodepool1-24398294-vmss000000:/# trivy filesystem --exit-code 1 --scanners vuln  --no-progress --timeout 1000s / > /tmp/vuln.txt
2023-10-27T19:24:45.360Z        INFO    Need to update DB
2023-10-27T19:24:45.360Z        INFO    DB Repository: ghcr.io/aquasecurity/trivy-db
2023-10-27T19:24:45.360Z        INFO    Downloading DB...
2023-10-27T19:25:08.937Z        INFO    Vulnerability scanning is enabled
2023-10-27T19:26:08.040Z        INFO    Detected OS: ubuntu
2023-10-27T19:26:08.045Z        INFO    Detecting Ubuntu vulnerabilities...
2023-10-27T19:26:08.646Z        INFO    Number of language-specific files: 3
2023-10-27T19:26:08.646Z        INFO    Detecting bundler vulnerabilities...

root@aks-nodepool1-24398294-vmss000000:/# cat /tmp/vuln.txt | grep HIGH
Total: 1280 (UNKNOWN: 0, LOW: 461, MEDIUM: 720, HIGH: 99, CRITICAL: 0)
│ curl                                  │ CVE-2023-38545   │ HIGH     │ fixed    │ 7.81.0-1ubuntu1.13           │ 7.81.0-1ubuntu1.14        │ heap based buffer overflow in the SOCKS5 proxy handshake     │
│ libcurl3-gnutls                       │ CVE-2023-38545   │ HIGH     │ fixed    │ 7.81.0-1ubuntu1.13           │ 7.

root@aks-nodepool1-24398294-vmss000000:/# cat /tmp/vuln.txt | grep HIGH | grep -v fixed
```


